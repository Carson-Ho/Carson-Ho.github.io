<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>史上最全解析Android消息推送解决方案 | Carson_Ho Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Android消息推送最全解决方案">
<meta property="og:type" content="article">
<meta property="og:title" content="史上最全解析Android消息推送解决方案">
<meta property="og:url" content="http://yoursite.com/2016/06/11/推送/index.html">
<meta property="og:site_name" content="Carson_Ho Blog">
<meta property="og:description" content="Android消息推送最全解决方案">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/944365-f798f04e48e48ea2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/944365-e72747568362c4c7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/944365-e46b65bb38969df7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/944365-aba2023aff9e30b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/944365-325b5691b6570474.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/944365-3085b51203e21450.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/944365-9b76fa3c52d478a7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2016-10-05T14:28:58.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="史上最全解析Android消息推送解决方案">
<meta name="twitter:description" content="Android消息推送最全解决方案">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/944365-f798f04e48e48ea2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
  
    <link rel="alternative" href="/atom.xml" title="Carson_Ho Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/head.png" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/">Carson_Ho</a></h1>
        </hgroup>

        
        <p class="header-subtitle">一个走在产品路上的Android攻城狮</p>
        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl CSDN" target="_blank" href="http://blog.csdn.net/carson_ho" title="CSDN">CSDN</a>
                            
                                <a class="fl github" target="_blank" href="https://github.com/Carson-Ho" title="github">github</a>
                            
                                <a class="fl 简书" target="_blank" href="http://www.jianshu.com/users/383970bef0a0/latest_articles" title="简书">简书</a>
                            
                                <a class="fl E-mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=mPv56uv39rbw99j_9_D1_fH0tvv39Q" title="E-mail">E-mail</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/Android基础/" style="font-size: 20px;">Android基础</a> <a href="/tags/Android常用汇总/" style="font-size: 20px;">Android常用汇总</a> <a href="/tags/多线程-源码分析/" style="font-size: 10px;">多线程&源码分析</a> <a href="/tags/源码分析/" style="font-size: 10px;">源码分析</a>
                    </div>
                </section>
                
                
                

                
                
                <section class="switch-part switch-part3">
                
                    <div id="js-aboutme">Android攻城狮、产品经理、健身狂热者、球鞋Sneaker。工作邮箱：carson.ho@foxmail.com</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Carson_Ho</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/head.png" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Carson_Ho</a></h1>
            </hgroup>
            
            <p class="header-subtitle">一个走在产品路上的Android攻城狮</p>
            
            <nav class="header-menu">
                <ul>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="CSDN" target="_blank" href="http://blog.csdn.net/carson_ho" title="CSDN">CSDN</a>
                    
                        <a class="github" target="_blank" href="https://github.com/Carson-Ho" title="github">github</a>
                    
                        <a class="简书" target="_blank" href="http://www.jianshu.com/users/383970bef0a0/latest_articles" title="简书">简书</a>
                    
                        <a class="E-mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=mPv56uv39rbw99j_9_D1_fH0tvv39Q" title="E-mail">E-mail</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-推送" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/11/推送/" class="article-date">
      <time datetime="2016-06-11T11:33:26.000Z" itemprop="datePublished">2016-06-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      史上最全解析Android消息推送解决方案
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android基础/">Android基础</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><ul>
<li>消息推送在Android开发中应用的场景是越来越多了，比如说电商产品进行活动宣传、资讯类产品进行新闻推送等等，如下图：<br><img src="http://upload-images.jianshu.io/upload_images/944365-f798f04e48e48ea2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="推送消息截图"></li>
</ul>
<ul>
<li>本文将介绍Android中实现消息推送的7种主流解决方案</li>
</ul>
<hr>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><p><img src="http://upload-images.jianshu.io/upload_images/944365-e72747568362c4c7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="目录"></p>
<hr>
<h1 id="1-定义"><a href="#1-定义" class="headerlink" title="1.定义"></a>1.定义</h1><p>在用户未打开App时，App主动向用户推送服务器最新消息。如下图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/944365-e46b65bb38969df7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><strong>消息推送的本质是：App将服务器更新的信息推送给用户</strong></p>
<h1 id="2-作用"><a href="#2-作用" class="headerlink" title="2.作用"></a>2.作用</h1><ul>
<li>产品的角度：功能需要，比如说资讯类产品的新闻推送、工具类产品的公告推送等等</li>
<li>运营的角度：活动运营需要，比如说电商类产品的促销活动；召回用户 / 提高活跃度等等</li>
</ul>
<blockquote>
<p>作为开发者，不要有需求就接，应该多思考、多理解用户 / 功能的使用场景，有助于我们更好地去选择合适的开发方式</p>
</blockquote>
<h1 id="3-储备知识"><a href="#3-储备知识" class="headerlink" title="3.储备知识"></a>3.储备知识</h1><h4 id="3-1-操作系统有自身的消息推送功能（系统级别）"><a href="#3-1-操作系统有自身的消息推送功能（系统级别）" class="headerlink" title="3.1 操作系统有自身的消息推送功能（系统级别）"></a>3.1 操作系统有自身的消息推送功能（系统级别）</h4><ul>
<li>系统级别：任何时候都可以推送给用户，且不会被系统杀死</li>
<li>Android的消息推送服务称为：C2DM（Cloudto Device Messaging）<blockquote>
<p>将在下面详细描述</p>
</blockquote>
</li>
</ul>
<h4 id="3-2-推送的本质与原理"><a href="#3-2-推送的本质与原理" class="headerlink" title="3.2 推送的本质与原理"></a>3.2 推送的本质与原理</h4><ul>
<li><p>消息推送的本质是：App将服务器更新的信息推送给用户，即App获取服务器信息，再推送给用户</p>
</li>
<li><p>App从服务器获取最新消息有两种基本方式（原理）：Push和Pull</p>
<ol>
<li><p>主动获取方式（Pull）<br>客户端隔固定时间<strong>主动</strong>向服务器获取信息，看是否有更新的信息；若有更新信息，则发送到客户端</p>
</li>
<li><p>被动接受方式（Push）<br>当服务器有更新信息时<strong>主动</strong>发送到客户端</p>
</li>
</ol>
</li>
<li><p>对比：Push方式比Pull方式更优越。因为采用Pull方式时客户端需要不停地去监测服务器的变化，更费客户端的资源（CPU资源、网络流量、系统电量）</p>
</li>
</ul>
<h1 id="4-解决方案"><a href="#4-解决方案" class="headerlink" title="4. 解决方案"></a>4. 解决方案</h1><p>经总结，Android中实现消息推送的有7种主流解决方案，接下来将一一介绍。</p>
<h4 id="4-1-C2DM"><a href="#4-1-C2DM" class="headerlink" title="4.1 C2DM"></a>4.1 C2DM</h4><ul>
<li>定义：Cloud to Device Messaging，云端推送<blockquote>
<p>Android系统级别的消息推送服务-Google出品</p>
</blockquote>
</li>
<li>原理：基于Push方式，C2DM服务负责处理诸如消息排队等事务，并向运行于目标设备上的应用程序分发这些消息。如下图：</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/944365-aba2023aff9e30b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="C2DM原理"></p>
<ul>
<li>优点：C2DM提供了一个简单的、轻量级的机制，允许服务器可以通知移动应用程序直接与服务器进行通信，以便于从服务器获取应用程序更新和用户数据。</li>
<li>缺点：<ol>
<li>依赖于Google官方提供的C2DM服务器，但在国内使用Google服务需要翻墙，成本较大；</li>
<li>需要用户手机安装Google服务。但由于Android机型、系统的碎片化 &amp; 国内环境，国内的Android系统都自动去除Google服务，假如要使用C2DM服务，这意味着用户还得去安装Google服务，成本较大。</li>
</ol>
</li>
</ul>
<h4 id="4-2-轮询"><a href="#4-2-轮询" class="headerlink" title="4.2 轮询"></a>4.2 轮询</h4><ul>
<li>原理：基于Pull方式，应用程序隔固定时间<strong>主动</strong>与服务器进行连接并查询是否有新的消息</li>
<li>缺点：<ol>
<li>成本大，需要自己实现与服务器之间的通信，例如消息排队等；</li>
<li>到达率不确定，考虑轮询的频率：太低可能导致消息的延迟；太高，更费客户端的资源（CPU资源、网络流量、系统电量）和服务器资源（网络带宽）</li>
</ol>
</li>
</ul>
<h4 id="4-3-SMS"><a href="#4-3-SMS" class="headerlink" title="4.3 SMS"></a>4.3 SMS</h4><ul>
<li>定义：短信发送</li>
<li>原理：基于Push方式，通过拦截SMS消息并且解析消息内容来了解服务器的意图，并获取其显示内容进行处理。</li>
<li>优点：可实现完全的实时操作</li>
<li>缺点：成本相对较高。因为目前来说，很难找到免费的短消息发送网关来实现这种方案，只能通过向运营商缴纳相应的短信费用</li>
</ul>
<h4 id="4-4-MQTT协议"><a href="#4-4-MQTT协议" class="headerlink" title="4.4 MQTT协议"></a>4.4 MQTT协议</h4><ul>
<li>定义：轻量级的消息发布/订阅协议</li>
<li>原理：基于Push方式，wmqtt.jar 是IBM提供的MQTT协议的实现，原理如下图：</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/944365-325b5691b6570474.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="MQTT协议原理"></p>
<blockquote>
<p>更多关于MQTT协议：</p>
<ol>
<li><a href="https://github.com/tokudu/AndroidPushNotificationsDemo" target="_blank" rel="external">项目实例源</a></li>
<li><a href="https://github.com/tokudu/PhpMQTTClient" target="_blank" rel="external">一个采用PHP书写的服务器端</a></li>
<li><a href="http://www-01.ibm.com/support/docview.wss?rs=171&amp;uid=swg24006006" target="_blank" rel="external">Jar包下载地址</a>，并加入自己的Android应用程序中。</li>
<li>拓展：RSMB是从MQTT协议引申出来的另外一种解决方案：简单的MQTT代理，详情<a href="http://www.alphaworks.ibm.com/tech/rsmb" target="_blank" rel="external">请点击</a></li>
</ol>
</blockquote>
<h4 id="4-5-XMPP协议"><a href="#4-5-XMPP协议" class="headerlink" title="4.5 XMPP协议"></a>4.5 XMPP协议</h4><ul>
<li><p>定义：Extensible Messageing and Presence Protocol，可扩展消息与存在协议，是基于可扩展标记语言（XML）的协议，是目前主流的四种IM协议之一</p>
<blockquote>
<p>其他三种：</p>
<ul>
<li>即时信息和空间协议（IMPP）</li>
<li>空间和即时信息协议（PRIM）</li>
<li>即时通讯和空间平衡扩充的进程开始协议SIP（SIMPLE）</li>
</ul>
</blockquote>
</li>
<li><p>原理：XMPP中定义了三个角色，分别是客户端、服务器和网关<br><strong>客户端</strong></p>
<ol>
<li>通过 TCP/IP与XMPP 服务器连接，然后在之上传输与即时通讯相关的指令（XML）；</li>
<li>解析组织好的 XML 信息包；</li>
<li>理解消息数据类型。<blockquote>
<ul>
<li>XMPP的核心：XML流传输协议（在网络上分片断发送XML的流协议），也是即时通讯指令的传递基础，即XMPP用TCP传的是XML流</li>
</ul>
<ol>
<li>与即时通讯相关的指令，在以前要么用2进制的形式发送（比如QQ），要么用纯文本指令加空格加参数加换行符的方式发送（比如MSN）。</li>
<li>XMPP传输的即时通讯指令的逻辑与以往相仿，只是协议的形式变成了XML格式的纯文本。</li>
</ol>
</blockquote>
</li>
</ol>
<p><strong>服务器</strong></p>
<ol>
<li>监听客户端连接，并直接与客户端应用程序通信（客户端信息记录）</li>
<li>与其他 XMPP 服务器通信；</li>
</ol>
<p><strong>网关</strong>：与异构即时通信系统进行通信</p>
<blockquote>
<p>异构系统包括SMS（短信），MSN，ICQ等</p>
</blockquote>
</li>
</ul>
<p>通信能够在这三者的任意两个之间双向发生。</p>
<p><strong>原理流程</strong></p>
<p><img src="http://upload-images.jianshu.io/upload_images/944365-3085b51203e21450.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="原理流程"></p>
<ul>
<li><p>优点：</p>
<ol>
<li>开源：可通过修改其源代码来适应我们的应用程序。</li>
<li>简单：XML易于解析和阅读；将复杂性从客户端转移到了服务器端</li>
<li>可拓展性强：继承了在XML环境中灵活的发展性，可进一步对协议进行扩展，实现更为完善的功能。 <blockquote>
<p>GTalk、QQ、IM等都用这个协议</p>
</blockquote>
</li>
</ol>
</li>
<li><p>缺点：如果将消息从服务器上推送出去，则不管消息是否成功到达客户端手机上。</p>
</li>
<li><p>源码实例：有一个很棒的基于XMPP协议的java开源Android push notification：Androidpn<a href="http://sourceforge.net/projects/androidpn/" target="_blank" rel="external">项目地址</a>，大家有兴趣可以去看看</p>
</li>
</ul>
<blockquote>
<p>更多关于XMPP协议更加详细<a href="http://www.cnblogs.com/hanyonglu/archive/2012/03/04/2378956.html" target="_blank" rel="external">请点击</a></p>
</blockquote>
<h4 id="4-6-使用第三方平台"><a href="#4-6-使用第三方平台" class="headerlink" title="4.6 使用第三方平台"></a>4.6 使用第三方平台</h4><ul>
<li><p>主流的第三方推送平台有：小米推送、极光推送、友盟推送、腾讯信鸽推送、百度推送、云巴（基于MQTT），这里不作过多描述，大家可以去官网进行详细了解</p>
</li>
<li><p>优点：</p>
<ol>
<li>成本低<br>上述的推送大多数是免费的，假如自己实现则消耗过多资源（开发成本和后台管理、统计成本）</li>
<li>消息到达率高<br>如果一个手机里有多个App使用了同一家推送服务，那么这些App将共用一条消息通道，即使你家的App推送服务被杀死了，那么只要用户打开了其他集成该推送服务的App，你家的推送就能到达用户</li>
</ol>
</li>
</ul>
<ul>
<li>缺点<ol>
<li>安全性低<br>使用别人的服务器，所以你懂的。</li>
<li>服务会被杀死<br>由于Android系统的机制，后台推送 Service 会被各种主动的或是被动的行为给杀死，而服务一旦被杀死，意味着就接收不到推送消息。</li>
</ol>
</li>
</ul>
<p><strong>第三方推送服务的选择</strong><br>第三方服务基本都具备免费、和到达率高的特点，那么应该怎么选择呢？大家请记住一个潜规则：操作系统是不会杀死属于自己品牌的推送服务。（你懂的）<br>比如说，Android原生系统是不会杀死C2DM消息推送服务，MIUI系统是不会杀死小米的推送服务。</p>
<p><strong>所以这就是一个巨大的优势了。</strong></p>
<p>当今市场上的Android手机系统份额最高是MIUI系统，即小米（具体排名请看<a href="http://www.umindex.com/）" target="_blank" rel="external">http://www.umindex.com/）</a></p>
<p>因为：免费、到达率高且在Android系统市场份额第一的MIUI上不被杀死，<strong>所以，请选择小米推送作为第三方平台实现推送服务</strong></p>
<blockquote>
<p>如果希望进一步提高推送的效果，可以集成多个推送服务，即针对不同的渠道用不同的推送，比如小米渠道用小米推送，华为渠道用华为推送，其他渠道用信鸽推送等，但是这种方式实现起来比较麻烦，具体怎么做看你们自己的权衡了。</p>
</blockquote>
<h4 id="4-7-自己搭建"><a href="#4-7-自己搭建" class="headerlink" title="4.7 自己搭建"></a>4.7 自己搭建</h4><p>如果你的产品对于消息推送具备较高的功能和性能要求，同时对安全性要求非常高的话，自己搭建可能是最好的方式，但这种方式无疑成本是最高的。</p>
<h1 id="5-总结"><a href="#5-总结" class="headerlink" title="5. 总结"></a>5. 总结</h1><ul>
<li>经过上面的详细讲解，相信大家现在对Android中消息推送的解决方案已经非常了解</li>
<li>解决方案没有优劣，要具具体使用场景而定。但一般来说，<strong>个人建议使用第三方平台推送，成本低+抵达率高</strong></li>
<li>接下来，我会继续讲解Android开发中其他知识，有兴趣可以继续关注<a href="http://www.jianshu.com/users/383970bef0a0/latest_articles" target="_blank" rel="external">Carson_Ho的安卓开发笔记</a></li>
</ul>
<hr>
<h3 id="欢迎关注Carson-Ho的简书！"><a href="#欢迎关注Carson-Ho的简书！" class="headerlink" title="欢迎关注Carson_Ho的简书！"></a>欢迎关注<a href="http://www.jianshu.com/users/383970bef0a0/latest_articles" target="_blank" rel="external">Carson_Ho</a>的简书！</h3><p>不定期分享关于<strong>安卓开发</strong>的干货，追求<strong>短、平、快</strong>，但<strong>却不缺深度</strong>。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/944365-9b76fa3c52d478a7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2016/06/11/推送/">史上最全解析Android消息推送解决方案</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 Carson_Ho 的个人博客">Carson_Ho</a></p>
        <p><span>发布时间:</span>2016年06月11日 - 19时33分</p>
        <p><span>最后更新:</span>2016年10月05日 - 22时28分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2016/06/11/推送/" title="史上最全解析Android消息推送解决方案">http://yoursite.com/2016/06/11/推送/</a>
            <span class="copy-path" data-clipboard-text="原文: http://yoursite.com/2016/06/11/推送/　　作者: Carson_Ho" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
  
    <a href="/2016/04/30/底部Tab菜单栏（FragmentTabHost+ViewPager+Fragment）/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Android开发：底部Tab菜单栏（FragmentTabHost+ViewPager+Fragment）</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#目录"><span class="toc-number">2.</span> <span class="toc-text">目录</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-定义"><span class="toc-number">3.</span> <span class="toc-text">1.定义</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-作用"><span class="toc-number">4.</span> <span class="toc-text">2.作用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-储备知识"><span class="toc-number">5.</span> <span class="toc-text">3.储备知识</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-操作系统有自身的消息推送功能（系统级别）"><span class="toc-number">5.0.0.1.</span> <span class="toc-text">3.1 操作系统有自身的消息推送功能（系统级别）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-推送的本质与原理"><span class="toc-number">5.0.0.2.</span> <span class="toc-text">3.2 推送的本质与原理</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-解决方案"><span class="toc-number">6.</span> <span class="toc-text">4. 解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-C2DM"><span class="toc-number">6.0.0.1.</span> <span class="toc-text">4.1 C2DM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-轮询"><span class="toc-number">6.0.0.2.</span> <span class="toc-text">4.2 轮询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-SMS"><span class="toc-number">6.0.0.3.</span> <span class="toc-text">4.3 SMS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-MQTT协议"><span class="toc-number">6.0.0.4.</span> <span class="toc-text">4.4 MQTT协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-XMPP协议"><span class="toc-number">6.0.0.5.</span> <span class="toc-text">4.5 XMPP协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6-使用第三方平台"><span class="toc-number">6.0.0.6.</span> <span class="toc-text">4.6 使用第三方平台</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-7-自己搭建"><span class="toc-number">6.0.0.7.</span> <span class="toc-text">4.7 自己搭建</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-总结"><span class="toc-number">7.</span> <span class="toc-text">5. 总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#欢迎关注Carson-Ho的简书！"><span class="toc-number">7.0.1.</span> <span class="toc-text">欢迎关注Carson_Ho的简书！</span></a></li></ol></li></ol></li></ol>
</div>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>





<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    
      <div class="duoshuo" id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="2016/06/11/推送/" data-title="史上最全解析Android消息推送解决方案" data-url="http://yoursite.com/2016/06/11/推送/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"null"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = '/js/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
    <!-- 多说公共JS代码 end -->
</div>

    



    <div class="scroll" id="post-nav-button">
        
            <a href="/" title="回到主页"><i class="fa fa-home"></i></a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/2016/04/30/底部Tab菜单栏（FragmentTabHost+ViewPager+Fragment）/" title="下一篇: Android开发：底部Tab菜单栏（FragmentTabHost+ViewPager+Fragment）">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/06/11/推送/">史上最全解析Android消息推送解决方案</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/30/底部Tab菜单栏（FragmentTabHost+ViewPager+Fragment）/">Android开发：底部Tab菜单栏（FragmentTabHost+ViewPager+Fragment）</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/20/Listview/">Android开发：ListView、AdapterView、RecyclerView全面解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/25/Json/">Android开发：JSON最全面解析方法(Gson、AS自带org.json、Jackson解析)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/23/五大布局属性大全/">Android开发： 五大布局属性设置大全</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/12/Intent详解/">Android开发：  Intent介绍及使用方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/05/XML简介及DOM、SAX、PULL解析对比/">Android开发：XML简介及DOM、SAX、PULL解析对比</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/01/ 最全面的HTTP知识总结/">Android网络通信：最全面的HTTP知识总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/07/Fragment详解/">Android开发： Fragment最全面使用详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/21/Activity生命周期/">Android开发：5分钟解析Activity&Fragment生命周期</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/21/底部Tab导航栏实现（TabLayout+ViewPager+Fragment）/">Android开发：顶部&底部Tab导航栏实现（TabLayout+ViewPager+Fragment）</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/11/Handler源码分析/">Android开发：Handler异步通信机制全面解析（包含Looper、Message Queue）</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/21/Android屏幕适配/">Android开发：最全面、最易懂的Android屏幕适配解决方案</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2016 Carson_Ho
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>